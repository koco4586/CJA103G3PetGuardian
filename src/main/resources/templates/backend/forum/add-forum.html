<!doctype html>
<html lang="zh-Hant" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Pet Guardian - 新增討論區</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="stylesheet" th:href="@{/css/backend/style.css}">

<style>
    /* 修正與優化後的 CSS */
    .form-container {
        background: var(--white, #fff);
        border-radius: 16px;
        padding: 32px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
        max-width: 1000px;
        margin: 20px auto;
        position: relative;
    }

    h1 {
        margin-bottom: 24px;
        color: var(--brown, #5d4037);
        font-size: 1.5rem;
        border-bottom: 2px solid #f0f0f0;
        padding-bottom: 10px;
    }

    .form-columns {
        display: flex;
        gap: 40px;
        flex-wrap: wrap;
    }

    .left-column, .right-column {
        flex: 1;
        min-width: 300px;
        display: flex;
        flex-direction: column;
    }

    .form-group {
        margin-bottom: 20px;
    }

    label {
        display: block;
        font-weight: 500;
        color: var(--brown, #5d4037);
        margin-bottom: 8px;
    }

    input[type="text"], input[type="file"] {
        padding: 12px;
        border-radius: 8px;
        border: 1px solid #ddd;
        width: 100%;
        box-sizing: border-box;
    }

    input:focus {
        border-color: var(--orange, #ff9800);
        outline: none;
    }

    #preview {
        display: block;
        margin-top: 15px;
        max-width: 100%;
        height: auto;
        max-height: 250px;
        border-radius: 8px;
        border: 2px dashed #ddd;
        padding: 5px;
    }

    /* 按鈕樣式 */
    .btn {
        background: var(--orange, #ff9800);
        color: #fff;
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        font-weight: 500;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
        transition: 0.3s;
        text-align: center;
    }

    .btn:hover {
        filter: brightness(1.1);
    }

    .btn.ghost {
        background: transparent;
        border: 1px solid var(--orange, #ff9800);
        color: var(--orange, #ff9800);
    }

    .btn.ghost:hover {
        background: var(--orange, #ff9800);
        color: #fff;
    }

    .form-submit {
        display: flex;
        justify-content: flex-end;
        gap: 12px;
        margin-top: auto; /* 推到最下面 */
        padding-top: 20px;
    }

    /* 錯誤訊息 */
    .error-box {
        background-color: #fff5f5;
        border: 1px solid #ffa39e;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 25px;
    }

    .error-title {
        margin-bottom: 5px;
	    color: #cf1322;     /* 深紅色 */
	    font-weight: 800;    /* 極粗體 */
	    list-style-type: disc;
    }

    .error-list {
        margin: 0;
        padding-left: 20px;
        font-weight: 800;
        color: #ff0000;
    }

    .error {
    	color: #ff0000;      /* 純紅 */
    	font-weight: 900;    /* 最粗體 */
        font-size: 0.85rem;
        margin-top: 5px;
        display: block;
    }

    @media (max-width: 768px) {
        .form-columns { flex-direction: column; gap: 20px; }
        .form-submit { justify-content: center; }
    }
</style>
</head>
<body>

<div class="main-content">
    <section>
        <div class="card form-container">
            <h1>新增討論區</h1>

            <form th:action="@{insert-forum}" method="post" th:object="${forumVO}" enctype="multipart/form-data">
                
                <div th:if="${#fields.hasAnyErrors()}" class="error-box">
                    <span class="error-title"> 
                        <i class="fas fa-exclamation-circle"></i> 錯誤訊息：
                    </span>
                    <ul class="error-list">
                        <li th:each="err : ${#fields.allErrors()}" th:text="${err}"></li>
                    </ul>
                </div>

                <div class="form-columns">
                    <div class="left-column">
                        <div class="form-group">
                            <label for="forumName">討論區名稱</label> 
                            <input type="text" th:field="*{forumName}" id="forumName" placeholder="請輸入討論區名稱" />
                            <span th:if="${#fields.hasErrors('forumName')}" th:errors="*{forumName}" class="error"></span>
                        </div>  
                    </div>

                    <div class="right-column">
                        <div class="form-group">
                            <label for="fileInput">討論區照片</label> 
                            <input type="file" th:field="*{upFile}" id="fileInput" /> 
                            <img id="preview" src="#" alt="預覽圖片" style="display: none;">
                        </div>

                        <div class="form-submit">
                            <a th:href="@{/admin/forum/list-all-forum}" class="btn ghost">取消</a>
                            <button type="submit" class="btn">新增討論區</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </section>
</div>

<script th:src="@{/js/backend/sidebar.js}"></script>
<script>
    // 圖片即時預覽
    const fileInput = document.getElementById('fileInput');
    const preview = document.getElementById('preview');
    
    fileInput.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(evt) {
                preview.src = evt.target.result;
                preview.style.display = 'block';
            }
            reader.readAsDataURL(file);
        } else {
            preview.src = "#";
            preview.style.display = 'none';
        }
    });
</script>

</body>
</html>