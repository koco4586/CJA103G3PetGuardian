<!doctype html>
<html lang="zh-Hant" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>Pet Guardian - 討論區管理</title>

	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

	<!-- 後台樣式 -->
	<link rel="stylesheet" th:href="@{/css/backend/style.css}">

	<style>
		table {
			width: 100%;
			border-collapse: collapse;
		}

		/* 標題與內容文字水平置中 */
		table th,
		table td {
			text-align: center;
			vertical-align: middle;
			/* 垂直置中 */
			padding: 12px;
			/* 增加一點間距讓畫面不擁擠 */
		}

		/* 針對圖片欄位的處理 */
		table td img {
			display: block;
			/* 轉為區塊元素 */
			margin: 0 auto;
			/* 水平置中 */
			border-radius: 8px;
			/* 稍微修圓角比較好看 */
		}

		/* 針對包含 Form/Button 的欄位，確保按鈕也能置中 */
		table td form {
			display: flex;
			justify-content: center;
			align-items: center;
			margin: 0;
			/* 移除 form 預設的外距 */
		}

		/* 停用 和 啟用的按鈕顏色 */
		.btn-enable {
			background-color: #4CAF50;
			/* 綠 */
			color: #fff;
		}

		.btn-disable {
			background-color: #f44336;
			/* 紅 */
			color: #fff;
		}

		.btn-enable:hover,
		.btn-disable:hover {
			opacity: 0.85;
		}

		/* =========================
	   DataTables 分頁樣式
	   ========================= */

		/* 分頁整體容器 */
		.dataTables_paginate {
			display: flex;
			justify-content: center;
			align-items: center;
			gap: 6px;
			margin-top: 20px;
			flex-wrap: wrap;
		}

		/* 分頁按鈕（上一頁 / 下一頁 / 頁碼） */
		.dataTables_paginate .paginate_button {
			padding: 6px 12px;
			border-radius: 8px;
			cursor: pointer;
			font-size: 0.95rem;
			color: #666 !important;
			background-color: #f5f5f5;
			border: none !important;
			transition: all 0.3s ease;
		}

		/* hover 效果 */
		.dataTables_paginate .paginate_button:hover {
			background-color: #eaeaea;
			color: #333 !important;
		}

		/* 目前頁碼 */
		.dataTables_paginate .paginate_button.current {
			background-color: var(--orange) !important;
			color: #fff !important;
			font-weight: 600;
		}

		/* disabled（例如第一頁的上一頁） */
		.dataTables_paginate .paginate_button.disabled {
			opacity: 0.4;
			cursor: not-allowed;
		}

		/* 移除 DataTables 預設藍色框線 */
		.dataTables_paginate .paginate_button:focus {
			outline: none;
			box-shadow: none;
		}

		/* 標題與按鈕的容器佈局 */
		.card-header-flex {
			display: flex;
			justify-content: space-between;
			/* 標題靠左，按鈕靠右 */
			align-items: center;
			/* 垂直居中 */
			margin-bottom: 20px;
			/* 與下方表格的間距 */
			padding-bottom: 10px;
			border-bottom: 1px solid #eee;
			/* 可選：加一條淺色分隔線 */
		}

		/* 移除標題預設的 margin 避免錯位 */
		.card-header-flex h3 {
			margin: 0;
		}

		/* 修正按鈕樣式 */
		.btn-add-forum {
			background-color: #2e7d32;
			/* 改為深綠色，比較符合新增語意 */
			color: white !important;
			font-weight: bold;
			text-decoration: none;
			padding: 10px 20px;
			border-radius: 8px;
			transition: all 0.3s ease;
			display: inline-flex;
			/* 使用 inline-flex 確保不會寬度撐開 */
			align-items: center;
			gap: 8px;
		}

		.btn-add-forum:hover {
			background-color: #1b5e20;
			/* 滑鼠移入變更深的綠 */
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
			transform: translateY(-2px);
		}
	</style>
</head>

<body>
	<div class="main-content">
		<header>
			<button class="menu-btn" onclick="toggleSidebar()">☰</button>

			<img src="https://images.unsplash.com/photo-1518791841217-8f162f1e1131?q=80&w=60&auto=format&fit=crop"
				alt="logo" style="width: 48px; height: 48px; border-radius: 10px; object-fit: cover;">
			<div>
				<h1>討論區管理</h1>
			</div>
		</header>

		<section>
			<div class="card">
				<div class="card-header-flex">
					<h3>討論區列表</h3>
					<a th:href="@{/admin/forum/add-forum}" class="btn-add-forum">
						<i class="fas fa-plus"></i>
						<span>新增討論區</span>
					</a>
				</div>
				<table id="example">
					<thead>
						<tr>
							<th>討論區編號</th>
							<th>討論區照片</th>
							<th>討論區名稱</th>
							<th>建立時間</th>
							<th>更新</th>
							<th>狀態</th>
						</tr>
					</thead>
					<tbody>
						<th:block th:each="forumVO : ${forumList}">
							<tr>
								<td th:text="${forumVO.forumId}"></td>
								<td><img th:src="@{/forum/picture(forumId=${forumVO.forumId})}"
										style="max-width: 320px; max-height: 100px; object-fit: cover;">
								</td>
								<td th:text="${forumVO.forumName}"></td>
								<td th:text="${forumVO.createdAt}"></td>
								<td>
									<form method="post" th:action="@{/admin/forum/get-one-for-update}">
										<input class="btn" type="submit" name="更新" value="更新">
										<input type="hidden" name="forumId" th:value="${forumVO.forumId}">
									</form>
								</td>
								<td>
									<form method="post" th:action="@{/admin/forum/get-forum-id-for-update-status}">
										<input class="btn" type="submit"
											th:value="${forumVO.forumStatus == 1 ? '停用' : '啟用'}"
											th:classappend="${forumVO.forumStatus == 1 ? 'btn-disable' : 'btn-enable'}">
										<input type="hidden" name="forumStatus" th:value="${forumVO.forumStatus}">
										<input type="hidden" name="forumId" th:value="${forumVO.forumId}">
									</form>
								</td>
							</tr>
					</tbody>
				</table>
			</div>
		</section>
	</div>
	<script th:src="@{/js/backend/sidebar.js}"></script>
	<!-- ●● jquery datatables 設定 -->

	<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
	<!-- ●●js for jquery datatables 用 -->

	<script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
	<!-- ●●js for jquery datatables 用 -->

	<script>
		$(document).ready(function () {
			$('#example').DataTable({
				lengthChange: false,
				pageLength: 3,
				"searching": true,  //搜尋功能, 預設是開啟
				"paging": true,     //分頁功能, 預設是開啟
				"ordering": false,   //排序功能, 預設是開啟
				"language": {
					"processing": "處理中...",
					"loadingRecords": "載入中...",
					"lengthMenu": "顯示 _MENU_ 筆結果",
					"zeroRecords": "沒有符合的結果",
					"info": "顯示第 _START_ 至 _END_ 筆結果，共<font color=red> _TOTAL_ </font>筆",
					"infoEmpty": "顯示第 0 至 0 筆結果，共 0 筆",
					"infoFiltered": "(從 _MAX_ 筆結果中過濾)",
					"infoPostFix": "",
					"search": "搜尋:",
					"paginate": {
						"first": "第一頁",
						"previous": "上一頁",
						"next": "下一頁",
						"last": "最後一頁"
					},
					"aria": {
						"sortAscending": ": 升冪排列",
						"sortDescending": ": 降冪排列"
					}
				}
			});
		});	
	</script>
</body>

</html>