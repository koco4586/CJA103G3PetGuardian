<!DOCTYPE html>
<html lang="zh-TW" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿æ¯è©³æƒ… - PetGuardian</title>

    <!-- çµ±ä¸€æ¨£å¼ -->
    <link rel="stylesheet" href="/css/frontend/style.css">
    <link rel="stylesheet" href="/css/frontend/components.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        .profile-header {
            background: linear-gradient(to bottom, #f8f9fa 50%, transparent 50%);
            padding-top: 2rem;
        }

        .profile-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 1rem;
        }

        .section-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #f0f0f0;
            color: var(--primary-color);
        }

        .service-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 0;
            border-bottom: 1px dashed #eee;
        }

        .service-item:last-child {
            border-bottom: none;
        }

        .price-text {
            color: var(--danger);
            font-weight: 600;
            font-size: 1.1rem;
        }

        .area-tag {
            background: #e3f2fd;
            color: #1976d2;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            display: inline-block;
            font-size: 0.9rem;
        }

        .review-card {
            border-bottom: 1px solid #eee;
            padding: 1rem 0;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .booking-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 1rem;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
        }
    </style>
</head>

<body style="padding-bottom: 80px;"> <!-- é ç•™åº•éƒ¨é ç´„æŒ‰éˆ•ç©ºé–“ -->

    <!-- Header -->
    <header id="main-header" class="header"></header>

    <div class="container" style="padding-top: 2rem;">
        <div class="row">
            <!-- å·¦å´ï¼šå€‹äººç°¡ä»‹ -->
            <div class="col-md-4">
                <div class="profile-card">
                    <!-- é è¨­é ­åƒæˆ–ä¿æ¯ä¸Šå‚³çš„é ­åƒ -->
                    <img src="/images/frontend/default-avatar.png" class="profile-avatar" alt="ä¿æ¯é ­åƒ">

                    <!-- B. ä¿æ¯åç¨± -->
                    <h2 class="mb-2" th:text="${sitter.sitterName}">ä¿æ¯åç¨±</h2>

                    <div class="d-flex justify-center align-center mb-3 text-warning">
                        <i class="fas fa-star"></i>
                        <span class="ms-1 fw-bold"
                            th:text="${sitter.sitterStarCount != null ? sitter.sitterStarCount : '0.0'}">5.0</span>
                        <span class="text-muted ms-1"
                            th:text="'(' + (${sitter.sitterRatingCount != null ? sitter.sitterRatingCount : 0}) + ' å‰‡è©•åƒ¹)'">(10
                            å‰‡è©•åƒ¹)</span>
                    </div>

                    <p class="text-muted" th:if="${sitter.sitterAdd}" th:text="'ğŸ“ ' + ${sitter.sitterAdd}">å°åŒ—å¸‚å¤§å®‰å€</p>
                </div>
            </div>

            <!-- å³å´ï¼šè©³ç´°è³‡è¨Š -->
            <div class="col-md-8">

                <!-- C & D. æœå‹™ç¨®é¡èˆ‡åƒ¹æ ¼ -->
                <div class="section-card">
                    <h3 class="section-title"><i class="fas fa-hand-holding-heart"></i> æœå‹™é …ç›®</h3>
                    <div th:if="${services != null and !services.isEmpty()}">
                        <div class="service-item" th:each="srv : ${services}">
                            <div>
                                <!-- [FIX] VO ç„¡ serviceNameï¼Œæš«æ™‚é¡¯ç¤º ID æˆ– switch æ˜ å°„ -->
                                <strong th:switch="${srv.serviceItemId}">
                                    <span th:case="1">åˆ°åºœç…§é¡§</span>
                                    <span th:case="2">é›ç‹—æœå‹™</span>
                                    <span th:case="3">å®¶åº­å¯„å®¿</span>
                                    <span th:case="4">æ´—æ¾¡ç¾å®¹</span>
                                    <span th:case="*">å…¶ä»–æœå‹™ (ID:[[${srv.serviceItemId}]])</span>
                                </strong>
                                <!-- [FIX] VO ç„¡ serviceDescï¼Œé¡¯ç¤ºå›ºå®šæ–‡å­— -->
                                <p class="text-muted mb-0 small">å°ˆæ¥­è²¼å¿ƒæœå‹™</p>
                            </div>
                            <!-- [FIX] å±¬æ€§åç¨±æ˜¯ defaultPrice -->
                            <span class="price-text" th:text="'$' + ${srv.defaultPrice}">$500</span>
                        </div>
                    </div>
                    <div th:if="${services == null or services.isEmpty()}" class="text-center text-muted">
                        æš«ç„¡è¨­å®šæœå‹™é …ç›®
                    </div>
                </div>

                <!-- E. æœå‹™åœ°å€ -->
                <div class="section-card">
                    <h3 class="section-title"><i class="fas fa-map-marker-alt"></i> æœå‹™åœ°å€</h3>
                    <div th:if="${serviceAreas != null and !serviceAreas.isEmpty()}">
                        <span th:each="area : ${serviceAreas}" class="area-tag">
                            <i class="fas fa-location-arrow"></i>
                            <span th:text="${area.area.cityName + ' ' + area.area.district}">å°åŒ—å¸‚ å¤§å®‰å€</span>
                        </span>
                    </div>
                    <div th:if="${serviceAreas == null or serviceAreas.isEmpty()}" class="text-center text-muted">
                        å…¨å€æœå‹™æˆ–æœªè¨­å®š
                    </div>
                </div>

                <!-- F. æ­·å²è©•åƒ¹ -->
                <div class="section-card">
                    <h3 class="section-title"><i class="fas fa-comments"></i> æ­·å²è©•åƒ¹</h3>

                    <div th:if="${reviews != null and !reviews.isEmpty()}">
                        <div class="review-card" th:each="review : ${reviews}">
                            <div class="review-header">
                                <!-- å‡è¨­ bookingOrder ä¸­æœ‰ member é—œè¯ï¼Œé€™è£¡ç°¡åŒ–é¡¯ç¤º -->
                                <strong>æœƒå“¡ <span th:text="${review.memId}">ID</span></strong>
                                <div class="text-warning" th:if="${review.sitterRating != null}">
                                    <i class="fas fa-star"
                                        th:each="i : ${#numbers.sequence(1, review.sitterRating)}"></i>
                                </div>
                            </div>
                            <!-- [FIX] å±¬æ€§åç¨±æ˜¯ sitterReview -->
                            <p class="mb-0 text-muted" th:text="${review.sitterReview}">å¾ˆæ£’çš„ä¿æ¯ï¼</p>
                            <small class="text-muted"
                                th:text="${#temporals.format(review.endTime, 'yyyy-MM-dd')}">2023-10-10</small>
                        </div>
                    </div>

                    <div th:if="${reviews == null or reviews.isEmpty()}" class="text-center text-muted py-3">
                        <i class="far fa-comment-dots fa-2x mb-2"></i>
                        <p>ç›®å‰å°šç„¡è©•åƒ¹ç´€éŒ„</p>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- G. åº•éƒ¨é ç´„æŒ‰éˆ• -->
    <div class="booking-bar container">
        <div class="d-none d-md-block">
            <h5 class="mb-0 text-primary" th:text="${sitter.sitterName}">ä¿æ¯åç¨±</h5>
            <small class="text-muted">å°ˆæ¥­ç”¨å¿ƒï¼Œå€¼å¾—ä¿¡è³´</small>
        </div>
        <div class="d-flex gap-2 w-100 w-md-auto justify-content-end">
            <a href="#" onclick="history.back()" class="btn btn-outline">
                <i class="fas fa-arrow-left"></i> è¿”å›
            </a>
            <!-- é€£çµåˆ°é ç´„é é¢ï¼Œå¸¶ä¸Š sitterId -->
            <a th:href="@{/booking/create(sitterId=${sitter.sitterId})}" class="btn btn-primary"
                style="min-width: 150px;">
                <i class="fas fa-calendar-check"></i> ç«‹å³é ç´„
            </a>
        </div>
    </div>

    <!-- Footer -->
    <footer id="main-footer" class="footer"></footer>

    <!-- JS -->
    <script src="/js/frontend/main.js"></script>

</body>

</html>